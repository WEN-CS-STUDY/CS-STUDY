### 트랜잭션

- 데이터 베이스에서 데이터 교환, 변경등의 역할을 수행하는 작업의 단위
- 데이터 변경을 안전하게 할 수 있도록 도와준다.
- 데이터베이스에 정상적으로 반영되는 것을 **커밋(Commit)**
- 데이터베이스에 정상적으로 반영되지 않아 이전 상태로 되돌리는 것을 **롤백(RollBack)**이라고 한다.

### 트랜잭션의 ACID 특징

1. 원자성 : DB에 모두 반영 or 모두 반영하지 않음
2. 일관성: 트랜잭션의 작업 처리 단위는 항상 일관성이 있어야 한다. 
3. 독립성 : 둘 이상의 트랜잭션이 동시에 수행되고 있다면 서로 독립적으로 실행되어야 한다. 
4. 영속성 : DB에 정상반영 되었다면 이 결과는 영구적으로 보관되어야 한다. 

### 트랜잭션 상태

![스크린샷 2025-11-25 오후 3.13.16.png](/ASSET/트랜잭션1.png)

### 트랜잭션 격리 수준

1. Uncommited Read
    1. 커밋되지 않은 데이터도 읽을 수 있음
    2. 가장 저 수준의 격리 단계
    
    ![image.png](/ASSET/트랜잭션2.png)
    
- 만약 이 상황에서 10번 트랜잭션이 마지막쯤에 오류가 발생해 롤백을 한다면 13번 트랜잭션은 수정한 이후 값을 읽고있기 때문에 데이터 부정합이 일어남 (Dirty Read)

1. Commited Read
    1. 커밋된 데이터만 읽을 수 있음
    
    ![image.png](/ASSET/트랜잭션3.png)
    
- 잘못된 값을 읽을 가능성이 적어짐
- 하지만 만약 13번 트랜잭션이 10번 트랜잭션의 commit 전에 읽고, commit 후에 읽으면 같은 트랜잭션에 대해서 다른 결과가 나올 수 있음 (Non-Repeatable Read)

1. Repeatable Read
    1. Non Repeatable Read 문제를 해결해주는 격리 수준이다.
    2. 자신 보다 큰 트랜잭션 ID를 가지는 트랜잭션의 commit이후 데이터는 읽을 수 없다. 
    
    ![image.png](/ASSET/트랜잭션4.png)
    
    - 13트랜잭션이 변경한 내용은 10트랜잭션이 읽을 수 없다. (커밋 이전 내용이 나옴)
    - 하지만 INSERT에 대해서는 막을 수 없기 때문에 조회 레코드 수가 달라지는 문제가 발생할 수 있다. (팬텀 리드)
    
2. **Serializable**
    1. 무조건 순차적으로 진행
    2. 당연히 순차적으로 진행하니 속도는 제일 느리다.